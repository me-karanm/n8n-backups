[{"createdAt":"2025-06-05T20:03:57.891Z","updatedAt":"2025-07-15T07:14:35.000Z","id":"cT8vfuMK3oifhx5h","name":"Check for Upcoming Webinar","active":false,"nodes":[{"parameters":{"operation":"executeQuery","query":"-- Metabase variable: {{days_ahead}} (number of days after today)\n-- e.g., days_ahead = 3 â†’ fetches events for next 3 days (excluding today)\n\nWITH boundaries AS (\n  SELECT\n    -- Start of tomorrow in IST, converted to UTC\n    (DATE_TRUNC('day', (NOW() + INTERVAL '{{ $json.start_interval }} day') AT TIME ZONE 'Asia/Kolkata') AT TIME ZONE 'Asia/Kolkata' AT TIME ZONE 'UTC') AS start_utc,\n    \n    -- End date = start + {{days_ahead}} days, also in UTC\n    (DATE_TRUNC('day', (NOW() + ({{ $json.end_interval }} + 1 || ' day')::interval) AT TIME ZONE 'Asia/Kolkata') AT TIME ZONE 'Asia/Kolkata' AT TIME ZONE 'UTC') AS end_utc\n)\nSELECT \n  w.*,\n  (w.date_time AT TIME ZONE 'UTC' AT TIME ZONE 'Asia/Kolkata')::date AS ist_date\nFROM public.webinar w\nJOIN boundaries b ON\n  w.date_time >= b.start_utc AND w.date_time < b.end_utc\nwhere w.is_meet_and_greet is false\nORDER BY w.date_time;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-20,-120],"id":"c245a208-a222-4532-beeb-73bbc067a4af","name":"Postgres","credentials":{"postgres":{"id":"UlHvqQraJFrdqkr2","name":"MF Prod Read"}}},{"parameters":{"inputSource":"passthrough"},"type":"n8n-nodes-base.executeWorkflowTrigger","typeVersion":1.1,"position":[-380,-120],"id":"3dff95df-9616-499f-975f-a64a1321fe1f","name":"When Executed by Another Workflow"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"6be2af6a-e127-47c8-9c2c-898119c75b37","leftValue":"={{ $json.is_meet_and_greet }}","rightValue":"","operator":{"type":"boolean","operation":"false","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[200,-120],"id":"2b85c44e-440e-4988-8ed4-240bcefabde5","name":"If"}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Postgres","type":"main","index":0}]]},"Postgres":{"main":[[{"node":"If","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":{"templateCredsSetupCompleted":true},"pinData":{"When Executed by Another Workflow":[{"json":{"start_interval":1,"end_interval":1}}]},"versionId":"a7bac57e-a5d1-4909-b14d-7421ece9952c","triggerCount":0,"tags":[{"createdAt":"2025-07-15T07:07:49.926Z","updatedAt":"2025-07-15T07:07:49.926Z","id":"wJnVPrhSbmXUFztc","name":"martech"}]}]