[{"createdAt":"2025-06-04T06:54:33.016Z","updatedAt":"2025-07-15T07:12:07.000Z","id":"sAmxSiSYyGj6KHlG","name":"Trigger Messages from Netcore Events","active":false,"nodes":[{"parameters":{"inputSource":"passthrough"},"id":"c055762a-8fe7-4141-a639-df2372f30060","typeVersion":1.1,"name":"When Executed by Another Workflow","type":"n8n-nodes-base.executeWorkflowTrigger","position":[-1060,600]},{"parameters":{"rules":{"values":[{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"new_enquiry_received","operator":{"type":"string","operation":"equals"},"id":"fd84afae-7fff-481e-9782-c1fc4e6df1af"}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"a1c62d2c-8231-4b4d-a081-906fb255f2ed","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"webinar_registration_confirmation","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"be7f8d30-92ff-4c74-8e3f-416024d92a83","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"webinar_registered_d_1_day","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"a5b10ff7-17b9-45c7-8c54-a1f0bae1f0d3","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"webinar_registered_d_day","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"b6a019d1-8572-4a9a-b8c7-8036cab046df","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"webinar_attended","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"52be0c78-8416-49f1-8edd-0bc8819f98b6","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"webinar_not_attended","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"8903b099-898b-4e18-ad87-53002b8a0b96","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"office_visit_confirmation_v1","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"fb184296-1acb-4935-b9ae-230e2c9c8f44","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"office_visit_attended","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"dd1eeda2-3836-4bbd-ac37-4eaf22cdb04e","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"office_visit_rescheduled","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"3afcad6f-bc8d-491d-a6b3-e671c40995be","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"office_visit_cancelled","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"31cdf09a-61ca-4790-a3ef-dd034ceb00e8","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"office_visit_reminder_d_1_day","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}},{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"cdb1829c-2b03-43a9-8385-5838b5b12e7f","leftValue":"={{ $json[\"event_params.activity_name\"] }}","rightValue":"office_visit_reminder_d_day","operator":{"type":"string","operation":"equals","name":"filter.operator.equals"}}],"combinator":"and"}}]},"options":{}},"type":"n8n-nodes-base.switch","typeVersion":3.2,"position":[40,580],"id":"c760e1d9-6f59-486c-bcba-5e746c9b778f","name":"Switch"},{"parameters":{"workflowId":{"__rl":true,"mode":"id","value":"H0GV91JEPlmSlIIw"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[480,160],"id":"0838d048-074a-4260-af0b-a2ad39e1b487","name":"Send Welcome Message - WATI"},{"parameters":{"jsCode":"// Step 1: Parse the stringified JSON inside body.data\nconst rawData =  $input.first().json.body.data;\nlet parsed;\n\ntry {\n  parsed = JSON.parse(rawData);\n} catch (e) {\n  throw new Error('Invalid JSON in body.data');\n}\n\nconst inputArray = parsed.mileseducationcee;\n\nif (!Array.isArray(inputArray)) {\n  throw new Error('mileseducationcee is not an array');\n}\n\n// Step 2: Helper to flatten nested objects\nfunction flattenObject(obj, parentKey = '', result = {}) {\n  for (let key in obj) {\n    const propKey = parentKey ? `${parentKey}.${key}` : key;\n    if (typeof obj[key] === 'object' && obj[key] !== null && !Array.isArray(obj[key])) {\n      flattenObject(obj[key], propKey, result);\n    } else {\n      result[propKey] = obj[key];\n    }\n  }\n  return result;\n}\n\n// Step 3: Map over the array and flatten each object\nconst output = inputArray.map(entry => {\n  return { json: flattenObject(entry) };\n});\n\nreturn output;\n"},"type":"n8n-nodes-base.code","typeVersion":2,"position":[-800,600],"id":"17687b42-cb3e-4ec5-a04f-3535cc9acd65","name":"Code"},{"parameters":{"workflowId":{"__rl":true,"value":"fLojeOek5Z4dUMAz","mode":"id"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[500,560],"id":"999d185e-49d6-49ea-9101-ce1636e8e689","name":"Webinar Message Sending Workflow"},{"parameters":{"workflowId":{"__rl":true,"mode":"id","value":"gxn5drysWMWlT7BD"},"workflowInputs":{"mappingMode":"defineBelow","value":{},"matchingColumns":[],"schema":[],"attemptToConvertTypes":false,"convertFieldsToString":true},"options":{}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.2,"position":[520,900],"id":"ef63d2c8-b0ce-4737-afdf-f0ff8154617b","name":"Office Visit Message Sending Workflow"},{"parameters":{"options":{}},"type":"n8n-nodes-base.splitInBatches","typeVersion":3,"position":[-580,600],"id":"0cdf7d85-2d92-4159-82d7-89fd62ecc6e4","name":"Loop Over Items"}],"connections":{"When Executed by Another Workflow":{"main":[[{"node":"Code","type":"main","index":0}]]},"Switch":{"main":[[],[{"node":"Webinar Message Sending Workflow","type":"main","index":0}],[{"node":"Webinar Message Sending Workflow","type":"main","index":0}],[{"node":"Webinar Message Sending Workflow","type":"main","index":0}],[{"node":"Webinar Message Sending Workflow","type":"main","index":0}],[{"node":"Webinar Message Sending Workflow","type":"main","index":0}],[{"node":"Office Visit Message Sending Workflow","type":"main","index":0}],[{"node":"Office Visit Message Sending Workflow","type":"main","index":0}],[{"node":"Office Visit Message Sending Workflow","type":"main","index":0}],[{"node":"Office Visit Message Sending Workflow","type":"main","index":0}],[{"node":"Office Visit Message Sending Workflow","type":"main","index":0}],[{"node":"Office Visit Message Sending Workflow","type":"main","index":0}]]},"Send Welcome Message - WATI":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Code":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Webinar Message Sending Workflow":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Office Visit Message Sending Workflow":{"main":[[{"node":"Loop Over Items","type":"main","index":0}]]},"Loop Over Items":{"main":[[],[{"node":"Switch","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"b9a33eb1-e4be-43fd-a853-32dcef49bea2","triggerCount":0,"tags":[{"createdAt":"2025-07-15T07:07:49.926Z","updatedAt":"2025-07-15T07:07:49.926Z","id":"wJnVPrhSbmXUFztc","name":"martech"}]}]